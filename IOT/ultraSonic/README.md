# 초음파 센서

핀맵과 코드를 아래의 페이지 그대로 참고하여 초음파센서 작동을 확인하였다.   
(https://rasino.tistory.com/349)

## 특징과 실험

1. 퍼지는 각도를 고려하여 초음파가 어느 정도의 간격으로 설치되어야 하는지   
손으로 그렸을 때, 퍼지는 각도는 대략적으로 (상하/좌우 각도 모두)50~55도 사이, 개인적으로는 50도라고 판단하고 있다.   
50도, 절반으로 나누면 25도라도 80cm정도 되면 대략 벽면에서 30cm 떨어진 사람 팔이 탐지되는데 문제가 될 지 모르겠다.   
(계산기 두들겨보니 25도에서의 탄젠트 * 80 하면 37.8이 나오는 것을 확인하였다, 거리가 멀어질 수록 물체 감지력이 떨어지는 것이 확실하다.)

    1. 초음파의 물체 인식 범위가 원뿔형 모양이라고 생각하면서 초음파 감지 범위를 실험했는데..  
    
    <img src='https://user-images.githubusercontent.com/19484971/182150212-e867b9ad-cf51-4132-8011-7ef1b166d2df.png' width=600>
    
    <img src='https://user-images.githubusercontent.com/19484971/182113733-327681c6-6210-436b-857c-61431656d821.jpg' width=600>
    
    결과는 아래의 사진의 오른쪽 아래의 붉은 색으로 그린 모양이 나왔다.   
    애매하게 알고 있었던 '거리가 멀어질수록 물체 감지 가능 각도가 떨어지는 것'도 확인할 수 있었다.   
    위의 실험으로 현재 진행하는 프로젝트에서는 최소 100 + 120cm 이상의 높이를 유지하는 것이 좋다고 판단하였다.   
    (초음파 하나로 약 50cm정도의 폭 내의 물체를 감지할 수 있는 최소 거리 + 유치원생 아이들의 평균 키)
    
    <img src='https://user-images.githubusercontent.com/19484971/182153195-5826be83-3d0d-4b2c-a287-27ea6b77b8ea.jpg' width=600>

2. 어느정도 가까워야 인식하는지   
가까움 정도는 문제가 크게 되지 않았다. 의외로 각도가 크게 영향을 끼친다.   
초음파 센서와 90도 정도의 각도를 이루는 바닥면은 감지하지 않으면서 필자의 팔이나 볼펜등은 감지하였다.   
위의 특징을 활용하면 어느정도 초음파가 정수리를 맞고 튕겨오는 상황을 막을 수 있을 것 같다.   
현재 줄자가 없어서 정확한 거리 측정은 못하고 있다.   

3. 얼마나 자주 거리를 판별할 수 있는지   
**0.4초**가 어느정도 신뢰성이 있는 데이터라고 판단하고 있으며 줄어들수록(더 빠르게 측정할 수록) 정확도가 크게 내려간다. 0.2초의 경우 거의 멋대로 나오는 정도;   
하지만, 0.4초로 설정하는 경우 터치를 인식 못하는 경우가 많이 생긴다. (손이 너무 빨라서 0.4초의 간격으로는 판단이 안 되는 경우)   

4. 어느정도의 두께를 가져야 거리를 판별 가능한지   
사람 팔 정도라면 문제 없이 판별된다.   
가까울 수록, 중심에서 가까울 수록 판별이 잘 된다.

5. 재질에 따라서 감지의 차이가 있는지
종이나 옷은 어느 정도 직선 방향 내에 있을 수록 더욱 잘 판별하고 평평한 물체(플라스틱)의 경우 각도(90도가 베스트)가 맞지 않으면 인식하지 못하는 경우도 있다.   
초음파가 비닐이나 옷을 투과하는지, 못 투과하는지   
비닐과 천옷은 잘 반사되는 것 같지만 합성수지인 옷 중에서 투과율이 좋은 옷이 있다.(재질 확인 불가)   

6. 초음파 센서 입구가 막히거나 이물질이 들어가면 어떻게 되는지   
3cm~700대의 cm 까지 다양한 오류값이 산출되버린다;;   

## 다수의 초음파 센서 작동 코드

처음에는 `Thread` 라이브러리를 사용했는데 코드를 실행만 시킬 수 있고 결과 값을 반환해주는 기능이 없어서 `concurrent.futures` 라이브러리로 바꾸어서 코딩하였다.

```
ssh 연결하기 귀찮으므로 내일 코드 추가
```
