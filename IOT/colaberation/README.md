# 협의 내용

## FE

입력이 언제 들어올지 모르는 상황상 라즈베리파이의 파이썬 파일과 프론트엔드의 파일 간의 통신 혹은 파일 혹은 함수를 가져오는 방식으로 구현할 예정이었으나..!

초음파 센서에 esp8266 wemos D1 min를 붙여 쉽게 설치하고 휴대가능한, 무선 데이터 송신 장치를 제작하자는 방향으로 기획이 바뀌었고..!

동시에 3D 모델링 캐릭터들을 라즈베리파이에서 보여주는 것은 어려운 상황이라는 점을 깨닫고 기능은 라즈베리파이에서, 화면은 노트북에서 보이게 되면서 통신 방식이 크게 변화하였다.

### 터치감지

아두이노 wifi 모듈에서 터치 데이터를 서버를 통해 react로 송신하는 코드가 필요하였다. 해당 과정에서 socket.io를 활용하였으며 아래의 기능에서도 해당 라이브러리를 사용하였다.

### 자세인식

TM에서 제작한 모델을 라즈베리파이의 서버에 넣고 웹캠을 통해 비춰진 사람의 자세인식을 하는 간단한 html 파일을 넣어 진행하였다. 

자세인식을 하였을 때 인식한 자세가 원하는 자세, 특정 조건 이상이라면 자세가 맞다는 택스트를 송신하고 직후에 해당 자세를 취했을 때의 이미지를 리액트로 전송한다. 물론 Socket.io를 활용한다.

현재 이미지 전송이 너무 느리다는 점이 있다, 무언가 송신을 비효율적으로 한 것 같은데 찾아보아야 할 것 같다.

또한 현재는 리액트 서버와 라즈베리파이의 서버가 별개로 있어 따로 작동하지만, 한 서버로 통합하게 된다면 한 파일에서 작동하게 될 것이다.

### 얼굴인식

face_recognition 라이브러리를 통해 개인적으로 준비한 사진을 학습한 얼굴인식 모델을 활용하여 웹캠을 통해 비춰진 사람이 누구인지 인식을 하는 기능을 넣었다.

이때 인식한 사람들의 이름을 서버를 통해 리액트로 전송하며 리액트에서는 인식한 사람의 이미지를 간단한 애니메이션을 통해 인식이 되었다는 것을 보인다.

다른 통신과 마찬가지로 socket.io를 사용하며 서버가 하나로 통합되면 자세인식과 마찬가지로 한 서버 내에서 리액트가 해당 파일을 불러 작동될 예정이다.

### 결과

도중에 기획이 크게 바뀌면서 글로 이해하기에는 너무 복잡한 흐름도를 가져 [한 블로그의 글](https://blog.naver.com/PostView.nhn?blogId=is_king&logNo=221539545122)을 보고 `draw.io` 를 활용하여 간단한 통신 흐름도(?)를 그렸다.

<img src="https://user-images.githubusercontent.com/19484971/185294578-ad6241b8-ab41-41b2-bb18-1790a4928d9e.png" width=500>

> 서버에 리엑트를 넣기 전   
> with [draw.io](https://www.draw.io/)

<img src="https://user-images.githubusercontent.com/19484971/185800022-1725d081-22ad-46f6-a34f-41eafd0184ec.png" width=500>

> 서버에 리엑트를 넣은 후 + 초음파 센서 각각을 표현   
> with [draw.io](https://www.draw.io/)

사실은 하나의 서버를 하나만 만들어도 되나, 각 기능을 맡은 팀원이 각자의 컴퓨터와 라즈베리파이에 node 서버를 만들어 테스트하고 두 서버를 합칠 시간이 없어서 그대로 서버가 2개가 되어버렸다.

개인적으로 수정해야하는 1순위 부분이다. 수정하게 된다면 라즈베리파이에 있는 서버를 다른 서버에 넣어주는 것이 좋겠다.

## BE

중간에 사진을 통신하는 기능을 넣으려고 하였으나, 기능이 간소화 되면서 사라졌다.

## 보완할 내용

지금은 블랜더로 만든 3D 캐릭터를 라즈베리파이에서 직접 송출하는 것이 큰 부담이라서 노트북을 사용하면서 리액트를 담는 노드서버가 하나 더 생겼다.

그런데! 컨설턴트님이 성능이 떨어지는 컴퓨터에서도 유튜브만 송출가능다면 저사양의 컴퓨터에서도 무거운 사양의 게임을 즐길 수 있는 `Stadia`에 대해 설명해주셨다.

해당 기술을 활용하면 노트북을 꼭 사용할 필요가 없어서 위의 통신 흐름도를 크게 간소화가 가능한 동시에 노드 서버도 하나로 통합할 수 있어 다음에 꼭 활용하고 싶었다. (혼자서라도..)

[Stadia GDC 2019 Gaming Announcement](https://www.youtube.com/watch?v=nUih5C5rOrA&t=14s)